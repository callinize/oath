/*!
 * oath - Node.js event emitter.
 * Copyright(c) 2011 Jake Luer <jake@alogicalparadox.com>
 * MIT Licensed
 */

!function(a,b){typeof module!="undefined"?module.exports=b():typeof define=="function"&&typeof define.amd=="object"?define(b):this[a]=b()}("oath",function(){function c(a){var b=this;a=a||{},this._pending=[],this._oath={complete:!1,parent:a.parent||null,context:a.context||this}}if(!a)var a={};var b=a.exports=c;return b.version="0.1.0",c.prototype.resolve=function(a){this._complete("resolve",a)},c.prototype.reject=function(a){this._complete("reject",a)},c.prototype.then=function(a,b){var c=this._oath.context,d={resolve:null,reject:null};return a&&(d.resolve=function(){a.apply(c,arguments)}),b&&(d.reject=function(){b.apply(c,arguments)}),this._pending.push(d),this._oath.complete&&this._traverse(),this},c.prototype.get=function(a){var b=new c({parent:this});return this.then(function(c){b.resolve(c[a])},function(a){b.reject(a)}),b},c.prototype.pop=function(){return this._oath.parent?this._oath.parent:this},c.prototype.call=function(a){var b=arguments;return this.then(function(c){return c[a].apply(c,Array.prototype.slice.call(b,1))})},c.prototype._complete=function(a,b){this._oath.complete={type:a,result:b},this._traverse()},c.prototype._traverse=function(){var a,b=this._oath.complete.type,c=this._oath.complete.result;while(this._pending[0])a=this._pending.shift()[b],a&&"function"==typeof a&&a(c)},b})